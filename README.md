# DENIM Downloading

## Description

This application enables to download repositories.

## Features

Here is a summary of the features currently supported.

### Download (git)

#### Description

The git download enables to retrieve one or several git repositories at once, each according to a given version (hash).

#### How to?

**__INPUT__**

Invoke the git download by using the [POST /git](http://locahost:3000/git) route with the following input object.

```json
[
  "https://(github|gitlab).com/<user>/<repository>/tree/<hash>",
  "https://(github|gitlab).com/<user>/<repository>/tree/<hash>",
  "..."
]
```

This one represent the list of GitHub/GitLab repositories to download, specific to a given version (hash).

⚠️ Each repository is downloaded according to a given version (hash).

⚠️ Please respect the input object format.

**__OUTPUT__**

The result of the download is a ZIP file containing as many directories as there are repositories.
The ZIP file also contains a file `denim` that reminds the original repository URL.

## Development details

### Setup

See [INSTALL file](INSTALL.md).

### Test the app (manually)

Manual test suites are set up thanks through the [Postman](https://www.postman.com/) tool.

The tests are specified in the `/test/manual` directory and are named following the `*.test.js` pattern.

### Test the app (unit testing)

Unit test suites are set up thanks to the [Jest](https://www.npmjs.com/package/jest) framework.

The tests are specified in the `/test/unit` directory and are named following the `*.test.js` pattern.

The configuration of Jest is stated in the `/package.json` file.

The tests running computes the code coverage.

#### Launching the tests

- Launch the unit tests.

  ```bash
  npm run test_unit
  ```

### Test the app (integration testing)

Integration test suites are set up thanks to the [SuperTest](https://www.npmjs.com/package/supertest) framework.

The tests are specified in the `/test/integration` directory and are named following the `*.test.js` pattern.

The configuration of Jest is stated in the `/package.json` file.

#### Preparing the environment with Docker

- Launch the application on Docker (cf. [Dockerize the application](#dockerize-the-application)).

#### Launching the tests

- Launching integration tests.

  ```bash
  npm run test_integration
  ```

### Documentation

An autogenerated documentation is available thanks to SwaggerUI
at [http://localhost:3000/docs](http://localhost:3000/docs).

- Generate the documentation.

  ```bash
  npm run swagger
  ```

### CI/CD

A CI/CD process is set up thanks to GitLab CI/CD.
Learn more about GitLab CI/CD via [this page](https://docs.gitlab.com/ee/ci/).

This one is described in the `.gitlab-ci.yml`.
Warning! Right privileges must be granted to Docker on the session on which the CI is executed.

## Technical details

### Technologies

* JavaScript
* Docker

### Libraries

#### Project configuration

* [expressjs](https://www.npmjs.com/package/express) is a backend NodeJS framework.
* [body-parser](https://www.npmjs.com/package/body-parser) is used for parsing REST API request body.

#### Tests

* [Jest](https://www.npmjs.com/package/jest) is used for unit testing.
* [SuperTest](https://www.npmjs.com/package/supertest) is used for integration testing.

#### Documentation

* [swagger-autogen](https://www.npmjs.com/package/swagger-autogen) is used for Swagger documentation.
* [swagger-ui-express](https://www.npmjs.com/package/swagger-ui-express) is used UI Swagger documentation.

#### Files

* [archiver](https://www.npmjs.com/package/archiver) is used for generating ZIP files.

### Tools

* [npm](https://www.npmjs.com/) is the package manager used.
* [GitLab CI/CD](https://docs.gitlab.com/ee/ci/) is the CI/CD continuous tool used.
* [Docker Desktop](https://docs.docker.com/desktop/windows/install/) is the containerization technology used.
* [Postman](https://www.postman.com/) is the tool for testing manually the API.